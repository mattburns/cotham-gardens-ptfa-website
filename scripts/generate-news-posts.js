// scripts/generate-news-posts.js

import fs from 'fs';
import path from 'path';

const contentDir = path.join(process.cwd(), 'src/content/_posts/news');
const outFile = path.join(process.cwd(), 'src/lib/news-posts.js');

const files = fs.readdirSync(contentDir)
  .filter(file => file.endsWith('.md'));

const imports = files.map((file, i) => {
  const name = `post${i}`;
  return `import ${name} from '@/content/_posts/news/${file}';`;
});

const entries = files.map((file, i) => {
  const name = `post${i}`;
  const slug = file.replace(/\.md$/, '');
  return `  {
    slug: '${slug}',
    ...${name}.attributes,
    Component: ${name}.react,
  }`;
});

const output = `// ⚠️ Auto-generated by scripts/generate-news-posts.js — do not edit manually

${imports.join('\n')}

export const newsPosts = [
${entries.join(',\n')}
];
`;

fs.writeFileSync(outFile, output, 'utf8');
console.log(`✅ Generated ${outFile}`);